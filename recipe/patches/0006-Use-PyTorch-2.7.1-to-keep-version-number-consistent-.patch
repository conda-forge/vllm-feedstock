From 4ba473d9854a6a6432ded4c3969c7ada07f92b63 Mon Sep 17 00:00:00 2001
From: Sherman Siu <s8siu@uwaterloo.ca>
Date: Sun, 31 Aug 2025 18:08:54 -0400
Subject: [PATCH 6/6] Use PyTorch 2.7.1 to keep version number consistent
 across builds

---
 requirements/cpu-build.txt |  2 +-
 requirements/cpu.txt       | 10 +++++-----
 2 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/requirements/cpu-build.txt b/requirements/cpu-build.txt
index 37f072202..62cb4d03c 100644
--- a/requirements/cpu-build.txt
+++ b/requirements/cpu-build.txt
@@ -6,7 +6,7 @@ packaging>=24.2
 setuptools>=77.0.3,<80.0.0
 setuptools-scm>=8
 --extra-index-url https://download.pytorch.org/whl/cpu
-torch==2.6.0+cpu
+torch==2.7.1
 wheel
 jinja2>=3.1.6
 regex
diff --git a/requirements/cpu.txt b/requirements/cpu.txt
index 6860275ac..fce060980 100644
--- a/requirements/cpu.txt
+++ b/requirements/cpu.txt
@@ -8,14 +8,14 @@ numba == 0.61.2; python_version > '3.9'
 packaging>=24.2
 setuptools>=77.0.3,<80.0.0
 --extra-index-url https://download.pytorch.org/whl/cpu
-torch==2.6.0+cpu; platform_machine == "x86_64" # torch>2.6.0+cpu has performance regression on x86 platform, see https://github.com/pytorch/pytorch/pull/151218
-torch==2.7.0; platform_system == "Darwin"
-torch==2.7.0; platform_machine == "ppc64le"
-torch==2.6.0; platform_machine == "aarch64" # for arm64 CPUs, torch 2.7.0 has a issue: https://github.com/vllm-project/vllm/issues/17960
+torch==2.7.1+cpu; platform_machine == "x86_64" # torch>2.6.0+cpu has performance regression on x86 platform, see https://github.com/pytorch/pytorch/pull/151218
+torch==2.7.1; platform_system == "Darwin"
+torch==2.7.1; platform_machine == "ppc64le"
+torch==2.7.1; platform_machine == "aarch64" # for arm64 CPUs, torch 2.7.0 has a issue: https://github.com/vllm-project/vllm/issues/17960
 
 # required for the image processor of minicpm-o-2_6, this must be updated alongside torch
 torchaudio; platform_machine != "ppc64le" and platform_machine != "s390x"
-torchaudio==2.7.0; platform_machine == "ppc64le"
+torchaudio==2.7.1; platform_machine == "ppc64le"
 
 # required for the image processor of phi3v, this must be updated alongside torch
 torchvision; platform_machine != "ppc64le" and platform_machine != "s390x"
